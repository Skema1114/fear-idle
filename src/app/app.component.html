<div class="navbar">
  <span>🕯️ Essência: {{ darkEssence() | number : "1.0-0" }}</span>
  <span>💰 Total: {{ totalEssence() | number : "1.0-0" }}</span>
  <span>⚡ Por segundo: {{ essencePerSecond() | number : "1.0-2" }}</span>
</div>

<div class="game">
  <div class="intro">
    <h1>🕯️ Culto das Sombras</h1>
    <p class="intro-animation">As trevas estão despertando...</p>
  </div>

  <p><strong>Essência Atual:</strong> {{ darkEssence() | number : "1.0-0" }}</p>
  <p>
    <strong>Essência Total:</strong> {{ totalEssence() | number : "1.0-0" }}
  </p>
  <p>
    <strong>Ganho por segundo:</strong>
    {{ essencePerSecond() | number : "1.0-2" }}
  </p>

  <button (click)="earnEssence(1)">Canalizar essência manualmente</button>

  <div class="purchase-modes">
    <label *ngFor="let mode of purchaseModes">
      <input
        type="radio"
        name="purchase"
        [value]="mode"
        [(ngModel)]="currentPurchaseMode"
      />
      {{ mode }}x
    </label>
  </div>

  <h2>🔮 Upgrades</h2>
  <ng-container *ngIf="unlockedUpgrades().length > 0; else noUpgradesAvailable">
    <div class="upgrades-container">
      <div class="upgrade" *ngFor="let up of unlockedUpgrades(); let i = index">
        <img
          [src]="up.image || 'https://via.placeholder.com/64x64?text=🧟'"
          [alt]="up.name"
          width="64"
          height="64"
        />
        <div class="details">
          <strong>{{ up.name }}</strong>
          <p>Qtd: {{ up.amount }} | +{{ up.dps | number : "1.0-2" }}/s cada</p>
          <p>Próximo custo: {{ up.cost | number : "1.0-0" }}</p>
          <button
            (click)="buyUpgrade(i, currentPurchaseMode)"
            [disabled]="!canAffordUpgrade(i, currentPurchaseMode)"
          >
            Comprar {{ currentPurchaseMode }}x
          </button>
        </div>
      </div>
    </div>
  </ng-container>
  <ng-template #noUpgradesAvailable>
    <div class="no-upgrades-message">
      <p>
        Você ainda não tem upgrades disponíveis. Continue coletando essência
        para desbloqueá-los!
      </p>
    </div>
  </ng-template>

  <h2>🏆 Troféus</h2>
  <ul class="trophies">
    <li *ngFor="let t of trophies()" [class.earned]="t.earned">
      {{ t.icon }} {{ t.title }}
    </li>
  </ul>
</div>

<div class="modal" *ngIf="showTrophyModal()">
  <div class="modal-content">
    <h3>{{ unlockedTrophy()?.icon }} {{ unlockedTrophy()?.title }}</h3>
    <p>{{ unlockedTrophy()?.description }}</p>
    <button (click)="closeModal()">Fechar</button>
  </div>
</div>
